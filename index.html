<!doctype html>
<html lang="en">
<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

	<style>
		.dropdowns {
			margin: 20px;
			height: 100px;
			background-color: lightgray;
			display: flex;
			justify-content: center;
			align-items: center;
			flex-wrap: wrap;
		}

		.restaurant-cards {
			margin: 20px;
			/* min-height: 500px; */
			max-height: 95vh;
			overflow-y: auto;
			display: flex;
			justify-content: center;
			align-items: center;
			flex-wrap: wrap;
			padding: 0 5em;
		}

		.about-us {
			/* height: 0px; */
			display: flex;
			background-color: gray;
			justify-content: center;
			align-items: center;
		}

		.card {
			width: 18rem;
			margin: 10px;
			padding: 10px;
			border-radius: 10px;
			box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
			display: flex;
			flex-direction: column;
			justify-content: start;
			align-items: start;
		}

	</style>
	<title>早安公雞</title>
</head>
<body>
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
		<a class="navbar-brand" href="./">早安公雞 農場晨食</a>
		<ul class="nav justify-content-center ml-auto">
			<li class="nav-item">
			  <a class="nav-link" id="cart-btn" tabindex="-1">購物車</a>
			</li>
		</ul>
	</nav>

	<div id="carouselIndicators" class="carousel slide" data-ride="carousel">
		<ol class="carousel-indicators">
			<li data-target="#carouselIndicators" data-slide-to="0" class="active"></li>
			<li data-target="#carouselIndicators" data-slide-to="1"></li>
			<li data-target="#carouselIndicators" data-slide-to="2"></li>
		</ol>
		<div class="carousel-inner">
			<div class="carousel-item active">
			<img class="d-block w-100" src="./image/banner.png" alt="First slide">
			</div>
			<div class="carousel-item">
			<img class="d-block w-100" src="./image/banner.png" alt="Second slide">
			</div>
			<div class="carousel-item">
			<img class="d-block w-100" src="./image/banner.png" alt="Third slide">
			</div>
			</div>
			<a class="carousel-control-prev" href="#carouselIndicators" role="button" data-slide="prev">
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="sr-only">Previous</span>
			</a>
			<a class="carousel-control-next" href="#carouselIndicators" role="button" data-slide="next">
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="sr-only">Next</span>
			</a>
		</div>
	<div class="dropdowns">
		<div class="col-12 col-sm-5 d-flex">
			<h6>選擇區域：</h6>
			<select id="regionDropdown" class="form-select form-select-lg col-8" aria-label="Region select">
				<option value="north" selected>北部</option>
				<option value="middle">中部</option>
				<option value="south">南部</option>
				<option value="outlying">花東離島</option>
			</select>
		</div>
		<div class="col-12 col-sm-5 d-flex">
			<h6>選擇縣市：</h6>
			<select id="subregionDropdown" class="form-select form-select-lg col-8" aria-label="Subregion select">
				<option value="1">新北市</option>
				<option value="2">桃園市</option>
				<option value="3">新竹市</option>
				<option value="4">新竹縣</option>
				<option value="5">苗栗縣</option>
			</select>
		</div>
    </div>

	<div class="restaurant-cards">
		<div class="card" data-city="1">
			<div class="d-flex justify-content-center col-12 mb-3">
				<img src="./image/restaurant.png" class="card-img-top" alt="...">
			</div>
			<div class="d-flex justify-content-between col-12">
				<div class="d-flex">
					<h5>新北實踐店</h5>
					<a href="https://goo.gl/maps/DgmqGSQRba2wxXrE8" target="_blank">&ensp;<i class="fa-solid fa-location-dot"></i></a>
				</div>
				<div><i class="fa-solid fa-star"></i>&nbsp;4.3</div>
			</div>
			<div class="d-flex justify-content-center col-12">
				<button class="btn btn-outline-success col-12" data-toggle="modal" data-target="#menuModal">立即訂餐</button>
			</div>
		</div>
	</div>
	<div class="about-us">
		<p>Copyright © 2023 All rights reserved</p>
	</div>

	<script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/js/all.min.js" integrity="sha512-uKQ39gEGiyUJl4AI6L+ekBdGKpGw4xJ55+xyJG7YFlJokPNYegn9KwQ3P8A7aFQAUtUsAQHep+d/lrGqrbPIDQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</body>
</html>


<script>

	
function getRestaurants(city) {
		$.ajax({
			url: 'backend/restaurants.php?city=' + city,
			method: 'GET',
			dataType: 'json',
			success: function(response) {
				$('.restaurant-cards').empty();
				for(var i = 0; i < response.length; i++) {
					var card = $('<div class="card" data-city="' + response[i].city + '"></div>');
					var cardHeader = $('<div class="d-flex justify-content-center col-12 mb-3"></div>');
					var cardImg = $('<img src="./image/restaurant.png" class="card-img-top" alt="...">');
					var cardBody = $('<div class="d-flex justify-content-between col-12"></div>');
					var cardTitle = $('<div class="d-flex"></div>');
					var cardTitleText = $('<h5>' + response[i].name + '</h5>');
					var cardTitleLink = $('<a href="' + response[i].google_map + '" target="_blank">&ensp;<i class="fa-solid fa-location-dot"></i></a>');
					var cardRating = $('<div><i class="fa-solid fa-star"></i>&nbsp;' + response[i].star + '</div>');
					var cardFooter = $('<div class="d-flex justify-content-center col-12"></div>');
					var cardButton = $('<button class="btn btn-outline-success col-12" onClick=location.href="menu.html?id=' + response[i].id + '">立即訂餐</button>');

					cardTitle.append(cardTitleText);
					cardTitle.append(cardTitleLink);
					cardHeader.append(cardImg);
					cardBody.append(cardTitle);
					cardBody.append(cardRating);
					cardFooter.append(cardButton);
					card.append(cardHeader);
					card.append(cardBody);
					card.append(cardFooter);
					$('.restaurant-cards').append(card);
				}
			},
			error: function(xhr, status, error) {
				console.log('Request failed: ' + status);
			}
		});
	}

	$(document).ready(function() {

		getRestaurants('1');

		$('#regionDropdown').change(function() {
			var selectedRegion = $(this).val();
			var subregionDropdown = $('#subregionDropdown');
			
			subregionDropdown.empty();
			
			if (selectedRegion === 'north') {
				subregionDropdown.append('<option value="1">新北市</option>');
				subregionDropdown.append('<option value="2">桃園市</option>');
				subregionDropdown.append('<option value="3">新竹市</option>');
				subregionDropdown.append('<option value="4">新竹縣</option>');
				subregionDropdown.append('<option value="5">苗栗縣</option>');
			} else if (selectedRegion === 'middle') {
				subregionDropdown.append('<option value="6">台中市</option>');
				subregionDropdown.append('<option value="7">南投縣</option>');
				subregionDropdown.append('<option value="8">彰化縣</option>');
			} else if (selectedRegion === 'south') {
				subregionDropdown.append('<option value="9">雲林縣</option>');
				subregionDropdown.append('<option value="10">台南市</option>');
				subregionDropdown.append('<option value="11">高雄市</option>');
			}
			else if (selectedRegion === 'outlying') {
				subregionDropdown.append('<option value="12">澎湖縣</option>');
				subregionDropdown.append('<option value="13">金門縣</option>');
				subregionDropdown.append('<option value="14">台東縣</option>');
			subregionDropdown.append('<option value="14">宜蘭縣</option>');
			}
			subregionDropdown.val(subregionDropdown.find('option:first').val());
			getRestaurants($('#subregionDropdown').val());
		});

		$('#subregionDropdown').change(function() {
			var selectedRegion = $(this).val();
			getRestaurants(selectedRegion);
		});
	});


</script>

